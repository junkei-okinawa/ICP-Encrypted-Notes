type DeviceError = variant {
  DeviceNotRegistered;
  AlreadyRegistered;
  UnknownPublicKey;
  KeyNotSynchronized;
};
type EncryptedNote = record { id : nat; data : text };
type SynchronizeKeyResult = variant { Ok : text; Err : DeviceError };
type RegisterKeyResult = variant { Ok; Err : DeviceError };
service : {
  addNote : (text) -> ();
  getNotes : () -> (vec EncryptedNote) query;
  deleteNote : (nat) -> ();
  updateNote : (EncryptedNote) -> ();
  registerDevice : (text, text) -> ();
  deleteDevice : (text) -> ();
  getDeviceAliases : () -> (vec text) query;
  isEncryptedSymmetricKeyRegistered : () -> (bool) query;
  registerEncryptedSymmetricKey : (text, text) -> (RegisterKeyResult);
  uploadEncryptedSymmetricKeys : (vec record { text; text }) -> (RegisterKeyResult);
  getUnsyncedPublicKeys : () -> (vec text) query;
  getEncryptedSymmetricKey : (text) -> (SynchronizeKeyResult) query;
};
